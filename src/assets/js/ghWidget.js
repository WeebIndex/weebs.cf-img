function appendToWidget(f,e,h,g){f=document.querySelector(f);e=document.createElement(e);e.innerHTML=g;e.className+=h;f.appendChild(e)}function getJSON(e,d){var f=new XMLHttpRequest;f.open("GET",e,!0);f.onload=function(){if(200===f.status){var b=JSON.parse(f.responseText);d(b)}};f.send()}function ready(b){"loading"!=document.readyState?b():document.addEventListener("DOMContentLoaded",b)}function start(){appendToWidget("body","style","","@import url(https://fonts.googleapis.com/css?family=Noto+Sans:400,700);.gh-widget-link,.gh-widget-link:hover{text-decoration:none}.gh-widget-container{display:flex;flex-direction:row;flex-wrap:no-wrap;align-items:center;justify-content:center;color:#333;font-family:'Noto Sans',sans-serif}.gh-widget-personal-details .bio,.gh-widget-stats .count{color:#EDABD1}.github-widget{border:1px solid #DDD;max-width:350px}.gh-widget-item{flex:1;text-align:center;padding:10px}.gh-widget-repositories .language{text-align:left}.gh-widget-repositories .language div,.gh-widget-repositories .stars div{padding:5px 0}.gh-widget-photo{flex:2}.gh-widget-photo img{border-radius:100%;max-width:90px}.gh-widget-personal-details{flex:6}.gh-widget-personal-details .full-name{font-size:1.5em;line-height:1.5em}.gh-widget-personal-details .location{font-size:.8em}.gh-widget-stats .count{font-size:1.2em;font-weight:700}.gh-widget-repositories .names{flex:2;text-align:left}.gh-widget-repositories .names div{padding:5px 0;text-overflow:ellipsis}.gh-widget-follow{flex:2}.gh-widget-active-time{flex:4;font-size:.8em}.gh-widget-heading{font-weight:400;color:#666}.gh-widget-hr{border:1px solid #DDD}.gh-widget-link{color:#EDABD1}.gh-widget-follow button{margin-top:2px;width:100%;height:2em;background-color:#fff;border-color:#ddd;border-size:1px;border-style:solid;}");for(var e=document.querySelectorAll(".github-widget"),d=0;d<e.length;d++){var f=e[d];f.setAttribute("id","widget"+d);appendToWidget("#widget"+d,"div","",'<div class="gh-widget-container"><div class="gh-widget-item gh-widget-photo"></div><div class="gh-widget-item gh-widget-personal-details"></div></div><div class="gh-widget-container gh-widget-stats"></div><hr class="gh-widget-hr"><div class="gh-widget-container"><div class="gh-widget-item gh-widget-heading">Top repositories</div></div><div class="gh-widget-repositories"></div><div class="gh-widget-container"><div class="gh-widget-item gh-widget-follow"></div><div class="gh-widget-item gh-widget-active-time"></div></div>');f=f.dataset.username;fetchRepos(f,"#widget"+d);fetchUserDetails(f,"#widget"+d)}}ready(start);function fetchRepos(d,c){getJSON("https://api.github.com/users/"+d+"/repos",function(b){updateRepoDetails(topRepos(b),c);updateLastPush(lastPushedDay(b),c)})}function fetchUserDetails(d,c){getJSON("https://api.github.com/users/"+d,function(b){updateUserDetails(b,c)})}function updateLastPush(d,c){appendToWidget(c+" .gh-widget-active-time","span","","Last active: "+(d?d+" day(s) ago":"Today"))}function lastPushedDay(h){for(var g=new Date,l,k=9999999999999,j=0;j<h.length;j++){var i=new Date(h[j].pushed_at);g-i<k&&(l=i,k=g-i)}return Math.floor((g-l)/86400000)}function updateUserDetails(d,c){appendToWidget(c+" .gh-widget-personal-details","div","full-name",d.name);d.bio&&appendToWidget(c+" .gh-widget-personal-details","div","bio",d.bio);appendToWidget(c+" .gh-widget-stats","div","gh-widget-item",'<div class="count">'+d.followers+'</div><div class="stat-name">Followers</div>');appendToWidget(c+" .gh-widget-stats","div","gh-widget-item",'<div class="count">'+d.following+'</div><div class="stat-name">Following</div>');appendToWidget(c+" .gh-widget-stats","div","gh-widget-item",'<div class="count">'+d.public_repos+'</div><div class="stat-name">Repositories</div>');appendToWidget(c+" .gh-widget-photo","span","",'<img src="'+d.avatar_url+'">');appendToWidget(c+" .gh-widget-follow","button","",'<a class="gh-widget-link" target="new" href="'+d.html_url+'">Follow</a>');appendToWidget(c+" .gh-widget-follow","button","",'<a class="gh-widget-link" target="new" href="'+d.blog+'">Website</a>')}function updateRepoDetails(e,d){for(var f=0;f<e.length;f++){appendToWidget(d+" .gh-widget-repositories","div","gh-widget-container",'<div class="gh-widget-item names"><div><a class="gh-widget-link" href="'+e[f].repoUrl+'">'+e[f].name+'</a></div></div><div class="gh-widget-item language"><div>'+(e[f].language?e[f].language:"Unknown")+'</div></div><div class="gh-widget-item stars"><div>&#9733;'+e[f].stars+"</div></div>")}}function topRepos(f){f.sort(function(d,c){return d.stargazers_count===c.stargazers_count?0:d.stargazers_count>c.stargazers_count?-1:1});f=f.slice(0,2);var e=[],h;for(h in f){var g=f[h];e.push({name:g.name,stars:g.stargazers_count,language:g.language,repoUrl:g.html_url})}return e};